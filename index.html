<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>충훈고등학교 급식충</title>
    <style>
      body {
        background-image: url("https://example.com/background-image.jpg");
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        border-top: 40px solid black;
        border-bottom: 40px solid black;
        padding: 200px;
        background-color: rgb(255, 255, 255);
        border-radius: 10px;
      }
      #mealInfo {
        resize: none;
      }
      .invalid-date {
        border-color: red;
      }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      function loadMealInfo() {
        const selectedDate = new Date($("#date").val());
        const dayOfWeek = selectedDate.getDay();

        if (dayOfWeek == 6 || dayOfWeek == 0) {
          $("#date").addClass("invalid-date");
          $("#mealInfo").val("");
          alert("토요일과 일요일은 선택할 수 없습니다.");
          return;
        }

        $("#date").removeClass("invalid-date");

        const schoolCode = "7530626"; // 학교 코드
        const date = $("#date").val().replace(/-/g, ""); // 날짜
        const mealType = "2"; // 급식 종류 (중식)

        const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?ATPT_OFCDC_SC_CODE=J10&SD_SCHUL_CODE=${schoolCode}&MLSV_YMD=${date}&MMEAL_SC_CODE=${mealType}&Type=json`;

        $.ajax({
          url: url,
          type: "GET",
          dataType: "jsonp",
          jsonp: "callback",
          success: function (data) {
            if (!data.mealServiceDietInfo[1]) {
              $("#mealInfo").val("");
              alert("해당 날짜의 급식 정보가 존재하지 않습니다.");
              return;
            }

            const menu = data.mealServiceDietInfo[1].row[0].DDISH_NM.replaceAll("<br/>", "\n");
            $("#mealInfo").val(menu);
          },
          error: function (xhr, status, error) {
            console.error(xhr);
            console.error(status);
            console.error(error);
            alert("데이터를 불러오는 중 오류가 발생했습니다.");
          },
        });
      }
    </script>
  </head>
  <body>
    <div class="container">
      <div id="logo"></div>
      <h1>충훈고 급식 정보</h1>
      <label for="date">날짜:</label>
      <input type="date" id="date" min="2023-05-01" max="2023-05-31" value="2023-05-03" /><br /><br />
      <label for="mealType">급식 종류:</label>
      <select id="mealType">
        <option value="2">중식</option>
      </select>
      <br /><br />
      <button type="button" onclick="loadMealInfo()">불러오기</button>
      <br /><br />
      <textarea id="mealInfo" rows="10" cols="50"></textarea>
    </div>
  </body>
</html>

